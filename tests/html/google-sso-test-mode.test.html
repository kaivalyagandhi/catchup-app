<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Google SSO Test Mode UI Test</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            max-width: 800px;
            margin: 50px auto;
            padding: 20px;
            background: #f5f5f5;
        }
        
        .test-section {
            background: white;
            padding: 20px;
            margin-bottom: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        h1 {
            color: #2563eb;
        }
        
        h2 {
            color: #333;
            margin-top: 0;
        }
        
        .test-result {
            padding: 10px;
            margin: 10px 0;
            border-radius: 4px;
            font-weight: 500;
        }
        
        .test-result.pass {
            background: #d1fae5;
            color: #065f46;
            border: 1px solid #10b981;
        }
        
        .test-result.fail {
            background: #fee2e2;
            color: #991b1b;
            border: 1px solid #ef4444;
        }
        
        .test-result.pending {
            background: #e0f2fe;
            color: #0369a1;
            border: 1px solid #0ea5e9;
        }
        
        button {
            background: #2563eb;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
            margin: 5px;
        }
        
        button:hover {
            background: #1d4ed8;
        }
        
        button.secondary {
            background: #6b7280;
        }
        
        button.secondary:hover {
            background: #4b5563;
        }
        
        .mock-auth-container {
            max-width: 400px;
            margin: 20px auto;
            background: white;
            padding: 40px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .google-sso-button {
            width: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 12px;
            padding: 12px 24px;
            background: #ffffff;
            color: #3c4043;
            border: 1px solid #dadce0;
            border-radius: 4px;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            margin-bottom: 20px;
        }
        
        .auth-divider {
            display: flex;
            align-items: center;
            text-align: center;
            margin: 20px 0;
            color: #6b7280;
        }
        
        .auth-divider::before,
        .auth-divider::after {
            content: '';
            flex: 1;
            border-bottom: 1px solid #e5e7eb;
        }
        
        .auth-divider span {
            padding: 0 10px;
            font-size: 12px;
            font-weight: 500;
        }
        
        .test-mode-notice {
            text-align: center;
            margin-top: 20px;
            padding: 8px 12px;
            background: #e0f2fe;
            color: #0369a1;
            border-radius: 4px;
            font-size: 12px;
            font-weight: 500;
        }
        
        .hidden {
            display: none !important;
        }
        
        input {
            width: 100%;
            padding: 10px;
            border: 1px solid #d1d5db;
            border-radius: 4px;
            font-size: 14px;
            margin-bottom: 15px;
        }
        
        label {
            display: block;
            margin-bottom: 5px;
            font-weight: 500;
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        .code-block {
            background: #f3f4f6;
            padding: 10px;
            border-radius: 4px;
            font-family: monospace;
            font-size: 12px;
            margin: 10px 0;
            overflow-x: auto;
        }
    </style>
</head>
<body>
    <h1>ðŸ§ª Google SSO Test Mode UI Test</h1>
    
    <div class="test-section">
        <h2>Test Mode Status</h2>
        <div id="test-mode-status" class="test-result pending">
            Checking test mode status...
        </div>
        <div class="code-block" id="test-mode-response"></div>
    </div>
    
    <div class="test-section">
        <h2>UI Behavior Tests</h2>
        
        <div>
            <button onclick="simulateTestModeEnabled()">Simulate Test Mode Enabled</button>
            <button onclick="simulateTestModeDisabled()" class="secondary">Simulate Test Mode Disabled</button>
        </div>
        
        <div id="ui-test-results"></div>
    </div>
    
    <div class="test-section">
        <h2>Mock Authentication UI</h2>
        <p>This demonstrates how the UI should look in different test mode states:</p>
        
        <div class="mock-auth-container">
            <h2 id="auth-title">Welcome to CatchUp</h2>
            
            <!-- Google SSO Button (Always Visible) -->
            <button id="google-sso-btn" class="google-sso-button" type="button">
                <svg width="18" height="18" viewBox="0 0 18 18" xmlns="http://www.w3.org/2000/svg">
                    <path d="M17.64 9.2c0-.637-.057-1.251-.164-1.84H9v3.481h4.844c-.209 1.125-.843 2.078-1.796 2.717v2.258h2.908c1.702-1.567 2.684-3.874 2.684-6.615z" fill="#4285F4"/>
                    <path d="M9.003 18c2.43 0 4.467-.806 5.956-2.18L12.05 13.56c-.806.54-1.836.86-3.047.86-2.344 0-4.328-1.584-5.036-3.711H.96v2.332C2.44 15.983 5.485 18 9.003 18z" fill="#34A853"/>
                    <path d="M3.964 10.712c-.18-.54-.282-1.117-.282-1.71 0-.593.102-1.17.282-1.71V4.96H.957C.347 6.175 0 7.55 0 9.002c0 1.452.348 2.827.957 4.042l3.007-2.332z" fill="#FBBC05"/>
                    <path d="M9.003 3.58c1.321 0 2.508.454 3.44 1.345l2.582-2.58C13.464.891 11.426 0 9.003 0 5.485 0 2.44 2.017.96 4.958L3.967 7.29c.708-2.127 2.692-3.71 5.036-3.71z" fill="#EA4335"/>
                </svg>
                <span>Sign in with Google</span>
            </button>
            
            <!-- Email/Password Form (Only in Test Mode) -->
            <div id="email-auth-form" style="display: none;">
                <div class="auth-divider">
                    <span>OR</span>
                </div>
                
                <form>
                    <div class="form-group">
                        <label for="auth-email">Email</label>
                        <input type="email" id="auth-email" placeholder="your@email.com">
                    </div>
                    
                    <div class="form-group">
                        <label for="auth-password">Password</label>
                        <input type="password" id="auth-password" placeholder="â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢">
                    </div>
                    
                    <button type="button" style="width: 100%;">Login</button>
                </form>
                
                <p class="test-mode-notice">ðŸ§ª Test Mode Enabled</p>
            </div>
        </div>
    </div>
    
    <div class="test-section">
        <h2>Requirements Validation</h2>
        <div id="requirements-validation"></div>
    </div>
    
    <script>
        // Test results tracking
        const testResults = {
            testModeCheck: false,
            uiShowHide: false,
            googleButtonVisible: false,
            testModeIndicator: false
        };
        
        // Check test mode status from backend
        async function checkTestModeStatus() {
            try {
                const response = await fetch('/api/auth/test-mode');
                const data = await response.json();
                
                const statusDiv = document.getElementById('test-mode-status');
                const responseDiv = document.getElementById('test-mode-response');
                
                if (response.ok) {
                    statusDiv.className = 'test-result pass';
                    statusDiv.textContent = `âœ“ Test mode status retrieved: ${data.enabled ? 'ENABLED' : 'DISABLED'}`;
                    responseDiv.textContent = JSON.stringify(data, null, 2);
                    testResults.testModeCheck = true;
                    
                    // Apply the actual test mode state to the mock UI
                    if (data.enabled) {
                        simulateTestModeEnabled();
                    } else {
                        simulateTestModeDisabled();
                    }
                } else {
                    statusDiv.className = 'test-result fail';
                    statusDiv.textContent = 'âœ— Failed to retrieve test mode status';
                    responseDiv.textContent = JSON.stringify(data, null, 2);
                }
                
                validateRequirements();
            } catch (error) {
                const statusDiv = document.getElementById('test-mode-status');
                statusDiv.className = 'test-result fail';
                statusDiv.textContent = `âœ— Error: ${error.message}`;
                document.getElementById('test-mode-response').textContent = error.stack;
            }
        }
        
        // Simulate test mode enabled
        function simulateTestModeEnabled() {
            const emailAuthForm = document.getElementById('email-auth-form');
            emailAuthForm.style.display = 'block';
            
            addTestResult('Test Mode Enabled: Email/password form is visible âœ“', true);
            testResults.uiShowHide = true;
            testResults.testModeIndicator = true;
            validateRequirements();
        }
        
        // Simulate test mode disabled
        function simulateTestModeDisabled() {
            const emailAuthForm = document.getElementById('email-auth-form');
            emailAuthForm.style.display = 'none';
            
            addTestResult('Test Mode Disabled: Email/password form is hidden âœ“', true);
            testResults.uiShowHide = true;
            testResults.testModeIndicator = true;
            validateRequirements();
        }
        
        // Add test result to UI
        function addTestResult(message, pass) {
            const resultsDiv = document.getElementById('ui-test-results');
            const resultDiv = document.createElement('div');
            resultDiv.className = `test-result ${pass ? 'pass' : 'fail'}`;
            resultDiv.textContent = message;
            resultsDiv.appendChild(resultDiv);
        }
        
        // Validate requirements
        function validateRequirements() {
            const validationDiv = document.getElementById('requirements-validation');
            validationDiv.innerHTML = '';
            
            const requirements = [
                {
                    id: '3.1',
                    text: 'Add logic to show/hide email/password form based on test mode',
                    met: testResults.uiShowHide
                },
                {
                    id: '3.2',
                    text: 'Fetch test mode status from backend on page load',
                    met: testResults.testModeCheck
                },
                {
                    id: '3.2',
                    text: 'Display test mode indicator when enabled',
                    met: testResults.testModeIndicator
                },
                {
                    id: '3.2',
                    text: 'Ensure Google SSO button is always visible',
                    met: true // Google button is outside email-auth-form div
                }
            ];
            
            requirements.forEach(req => {
                const reqDiv = document.createElement('div');
                reqDiv.className = `test-result ${req.met ? 'pass' : 'pending'}`;
                reqDiv.textContent = `${req.met ? 'âœ“' : 'â—‹'} Requirement ${req.id}: ${req.text}`;
                validationDiv.appendChild(reqDiv);
            });
            
            // Check if Google SSO button is visible
            const googleBtn = document.getElementById('google-sso-btn');
            if (googleBtn && window.getComputedStyle(googleBtn).display !== 'none') {
                testResults.googleButtonVisible = true;
            }
        }
        
        // Run tests on page load
        window.addEventListener('DOMContentLoaded', () => {
            checkTestModeStatus();
            validateRequirements();
        });
    </script>
</body>
</html>
