<!DOCTYPE html>
<html>
<head>
    <title>Tab Navigation Quick Test</title>
    <style>
        body { font-family: Arial; padding: 20px; }
        .tabs { display: flex; gap: 10px; margin-bottom: 20px; border-bottom: 2px solid #ddd; }
        .tab { padding: 10px 20px; cursor: pointer; border: none; background: none; }
        .tab.active { border-bottom: 3px solid blue; color: blue; font-weight: bold; }
        .content { display: none; padding: 20px; background: #f5f5f5; }
        .content.active { display: block; }
        .info { background: #e3f2fd; padding: 15px; margin: 10px 0; border-radius: 4px; }
    </style>
</head>
<body>
    <h1>Tab Navigation Test</h1>
    
    <div class="info">
        <strong>Current URL Hash:</strong> <span id="hash-display">(none)</span><br>
        <strong>Current Tab:</strong> <span id="tab-display">contacts</span>
    </div>
    
    <div class="tabs">
        <button class="tab active" data-tab="contacts">Contacts</button>
        <button class="tab" data-tab="circles">Circles</button>
        <button class="tab" data-tab="groups">Groups</button>
        <button class="tab" data-tab="tags">Tags</button>
    </div>
    
    <div class="content active" id="contacts">
        <h2>Contacts Tab</h2>
        <p>This is the contacts content.</p>
        <input type="text" placeholder="Search contacts..." id="search-input">
    </div>
    
    <div class="content" id="circles">
        <h2>Circles Tab</h2>
        <p>This is the circles content.</p>
    </div>
    
    <div class="content" id="groups">
        <h2>Groups Tab</h2>
        <p>This is the groups content.</p>
    </div>
    
    <div class="content" id="tags">
        <h2>Tags Tab</h2>
        <p>This is the tags content.</p>
    </div>
    
    <script>
        let currentTab = 'contacts';
        let tabStates = {
            contacts: { searchValue: '' },
            circles: {},
            groups: {},
            tags: {}
        };
        
        function updateDisplay() {
            document.getElementById('hash-display').textContent = window.location.hash || '(none)';
            document.getElementById('tab-display').textContent = currentTab;
        }
        
        function switchTab(tabId) {
            // Save current state
            if (currentTab === 'contacts') {
                tabStates.contacts.searchValue = document.getElementById('search-input').value;
            }
            
            // Update current tab
            currentTab = tabId;
            
            // Update URL hash
            window.history.replaceState(null, '', `#directory/${tabId}`);
            
            // Update UI
            document.querySelectorAll('.tab').forEach(t => {
                t.classList.toggle('active', t.dataset.tab === tabId);
            });
            
            document.querySelectorAll('.content').forEach(c => {
                c.classList.toggle('active', c.id === tabId);
            });
            
            // Restore state
            if (tabId === 'contacts') {
                document.getElementById('search-input').value = tabStates.contacts.searchValue;
            }
            
            updateDisplay();
        }
        
        // Attach click handlers
        document.querySelectorAll('.tab').forEach(tab => {
            tab.addEventListener('click', () => switchTab(tab.dataset.tab));
        });
        
        // Handle hash changes
        window.addEventListener('hashchange', () => {
            const hash = window.location.hash;
            if (hash.startsWith('#directory/')) {
                const tab = hash.split('/')[1];
                if (['contacts', 'circles', 'groups', 'tags'].includes(tab)) {
                    switchTab(tab);
                }
            }
        });
        
        // Initialize
        const hash = window.location.hash;
        if (hash.startsWith('#directory/')) {
            const tab = hash.split('/')[1];
            if (['contacts', 'circles', 'groups', 'tags'].includes(tab)) {
                switchTab(tab);
            }
        }
        
        updateDisplay();
        
        console.log('✓ Tab navigation initialized');
        console.log('✓ Try clicking tabs to switch');
        console.log('✓ Try entering text in search box, switching tabs, and coming back');
        console.log('✓ Try manually changing URL hash to #directory/groups');
    </script>
</body>
</html>
